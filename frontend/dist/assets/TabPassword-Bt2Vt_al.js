import{r as P,a7 as V,j as s,M as X,bq as H,aW as J,aX as y,aP as C,G as n,S as h,J as b,X as S,I as A,b4 as k,B as R,T as U,af as W,ao as t,ag as c,Z as l,d as L}from"./index-BE75cmpZ.js";import{c as _}from"./Users-4Bn6yUGa.js";import{m as M,i as N,a as q,b as T,c as z}from"./password-validation-DO7-1Ri2.js";import{I}from"./InputAdornment-CY-Tyt4a.js";import{E}from"./Eye-BRgheOyE.js";import{E as O}from"./EyeSlash-CGe2uNp7.js";import{L as p}from"./ListItem-eemVPKEi.js";import{M as m}from"./Minus-YvqWlFLu.js";import"./ListItemSecondaryAction-DuTfPZL3.js";function ns(){const[j,B]=P.useState(!1),[u,D]=P.useState(!1),[f,F]=P.useState(!1),{logout:v,user:o}=V(),$=()=>{B(!j)},Z=()=>{D(!u)},G=()=>{F(!f)},g=r=>{r.preventDefault()};return s.jsx(X,{title:"Change Password",children:s.jsx(H,{initialValues:{old:"",password:"",confirm:"",submit:null},validationSchema:J().shape({old:y().required("Old Password is required"),password:y().required("New Password is required").matches(/^.*(?=.{8,})((?=.*[!@#$%^&*()\-_=+{};:,<.>]){1})(?=.*\d)((?=.*[a-z]){1})((?=.*[A-Z]){1}).*$/,"Password must contain at least 8 characters, one uppercase, one number and one special case character"),confirm:y().required("Confirm Password is required").test("confirm","Passwords don't match.",(r,a)=>a.parent.password===r)}),onSubmit:async(r,{resetForm:a,setErrors:d,setStatus:w,setSubmitting:x})=>{try{(await _({fullname:o==null?void 0:o.fullname,email:o==null?void 0:o.email,password:r==null?void 0:r.password,old:r==null?void 0:r.old,active:o==null?void 0:o.active})).message=="success"?(C({open:!0,message:"Password changed successfully.",variant:"alert",alert:{color:"success"}}),a(),w({success:!1}),x(!1)):C({open:!0,message:"Old Password does not match.",variant:"alert",alert:{color:"error"}})}catch(i){C({open:!0,message:i.message,variant:"alert",alert:{color:"error"}}),w({success:!1}),d({submit:i.message}),x(!1)}},children:({errors:r,handleBlur:a,handleChange:d,handleSubmit:w,isSubmitting:x,touched:i,values:e})=>s.jsx("form",{noValidate:!0,onSubmit:w,children:s.jsxs(n,{container:!0,spacing:3,children:[s.jsxs(n,{item:!0,container:!0,spacing:3,xs:12,sm:6,children:[s.jsxs(n,{item:!0,xs:12,children:[s.jsxs(h,{spacing:1,children:[s.jsx(b,{htmlFor:"password-old",children:"Old Password"}),s.jsx(S,{placeholder:"Enter Old Password",id:"password-old",type:j?"text":"password",value:e.old,name:"old",onBlur:a,onChange:d,endAdornment:s.jsx(I,{position:"end",children:s.jsx(A,{"aria-label":"toggle password visibility",onClick:$,onMouseDown:g,edge:"end",size:"large",color:"secondary",children:j?s.jsx(E,{}):s.jsx(O,{})})}),autoComplete:"password-old"})]}),i.old&&r.old&&s.jsx(k,{error:!0,id:"password-old-helper",children:r.old})]}),s.jsxs(n,{item:!0,xs:12,children:[s.jsxs(h,{spacing:1,children:[s.jsx(b,{htmlFor:"password-password",children:"New Password"}),s.jsx(S,{placeholder:"Enter New Password",id:"password-password",type:u?"text":"password",value:e.password,name:"password",onBlur:a,onChange:d,endAdornment:s.jsx(I,{position:"end",children:s.jsx(A,{"aria-label":"toggle password visibility",onClick:Z,onMouseDown:g,edge:"end",size:"large",color:"secondary",children:u?s.jsx(E,{}):s.jsx(O,{})})}),autoComplete:"password-password"})]}),i.password&&r.password&&s.jsx(k,{error:!0,id:"password-password-helper",children:r.password})]}),s.jsxs(n,{item:!0,xs:12,children:[s.jsxs(h,{spacing:1,children:[s.jsx(b,{htmlFor:"password-confirm",children:"Confirm Password"}),s.jsx(S,{placeholder:"Enter Confirm Password",id:"password-confirm",type:f?"text":"password",value:e.confirm,name:"confirm",onBlur:a,onChange:d,endAdornment:s.jsx(I,{position:"end",children:s.jsx(A,{"aria-label":"toggle password visibility",onClick:G,onMouseDown:g,edge:"end",size:"large",color:"secondary",children:f?s.jsx(E,{}):s.jsx(O,{})})}),autoComplete:"password-confirm"})]}),i.confirm&&r.confirm&&s.jsx(k,{error:!0,id:"password-confirm-helper",children:r.confirm})]})]}),s.jsx(n,{item:!0,xs:12,sm:6,children:s.jsxs(R,{sx:{p:{xs:0,sm:2,md:4,lg:5}},children:[s.jsx(U,{variant:"h5",children:"New password must contain:"}),s.jsxs(W,{sx:{p:0,mt:1},children:[s.jsxs(p,{divider:!0,children:[s.jsx(t,{sx:{color:M(e.password)?"success.main":"inherit"},children:M(e.password)?s.jsx(c,{}):s.jsx(m,{})}),s.jsx(l,{primary:"At least 8 characters"})]}),s.jsxs(p,{divider:!0,children:[s.jsx(t,{sx:{color:N(e.password)?"success.main":"inherit"},children:N(e.password)?s.jsx(c,{}):s.jsx(m,{})}),s.jsx(l,{primary:"At least 1 lower letter (a-z)"})]}),s.jsxs(p,{divider:!0,children:[s.jsx(t,{sx:{color:q(e.password)?"success.main":"inherit"},children:q(e.password)?s.jsx(c,{}):s.jsx(m,{})}),s.jsx(l,{primary:"At least 1 uppercase letter (A-Z)"})]}),s.jsxs(p,{divider:!0,children:[s.jsx(t,{sx:{color:T(e.password)?"success.main":"inherit"},children:T(e.password)?s.jsx(c,{}):s.jsx(m,{})}),s.jsx(l,{primary:"At least 1 number (0-9)"})]}),s.jsxs(p,{children:[s.jsx(t,{sx:{color:z(e.password)?"success.main":"inherit"},children:z(e.password)?s.jsx(c,{}):s.jsx(m,{})}),s.jsx(l,{primary:"At least 1 special characters"})]})]})]})}),s.jsx(n,{item:!0,xs:12,children:s.jsxs(h,{direction:"row",justifyContent:"flex-end",alignItems:"center",spacing:2,children:[s.jsx(L,{variant:"outlined",color:"secondary",children:"Cancel"}),s.jsx(L,{disabled:x||Object.keys(r).length!==0,type:"submit",variant:"contained",children:"Save"})]})})]})})})})}export{ns as default};
